schema: EconSchema

params:

- {name: disc, value: 0}
- {name: mc, value: 1.5}
- {name: P, value: 3, min: 2, max: 9}
- {name: QD, value: 1, min: 1, max: 7}


calcs:

  QA: " (params.P >= 8) ? (1) : ( (params.P >= 6) ? (2) : ( (params.P >= 4) ? (3) : ( 4 ) ) ) "
  QB: " (params.P >= 7) ? (0) : ( (params.P >= 5) ? (1) : ( (params.P >= 3) ? (2) : ( 3 ) ) ) "
  Q: " (params.disc == 0) ? (calcs.QA)+(calcs.QB) : (params.QD) "

  CSA: " (params.P == 9) ? (0) : ( (params.P == 8) ? (1) : ( (params.P == 7) ? (2) : ( (params.P == 6) ? (4) : ( (params.P == 5) ? (6) : ( (params.P == 4) ? (9) : ( (params.P == 3) ? (12) : ( 16 ) ) ) ) ) ) ) "
  CSB: " (params.P == 9) ? (0) : ( (params.P == 8) ? (0) : ( (params.P == 7) ? (0) : ( (params.P == 6) ? (0) : ( (params.P == 5) ? (1) : ( (params.P == 4) ? (2) : ( (params.P == 3) ? (4) : ( 6 ) ) ) ) ) ) ) "

  profit0: (calcs.Q)*((params.P)-(params.mc)) # profit with no discrimination

  CS: (calcs.CSA)+(calcs.CSB)

  profit1: " (params.QD==1) ? (7.5) : ( (params.QD==2) ? (13) : ( (params.QD==3) ? (17.5) : ( (params.QD==4) ? (21) : ( (params.QD==5) ? (23.5) : ( (params.QD==6) ? (25) : ( 25.5 ) ) ) ) ) ) "


aspectRatio: 2

layout:
  ThreeHorizontalGraphs:

    leftGraph:
      xAxis:
        max: 9
        ticks: 0
        title: Alice
      yAxis:
        max: 10.5
        ticks: 0


      objects:

      - Label:
              coordinates: [9, 0]
              text: "` \\\\text{    tickets} `"
      - Label:
              coordinates: [0, 10.5]
              text: "` \\\\text{euros per ticket}  `"

# Alice demand
      - Point: {coordinates: [1, 9], droplines: {vertical: 1, horizontal: 9}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [2, 7], droplines: {vertical: 2, horizontal: 7}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [3, 5], droplines: {vertical: 3, horizontal: 5}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [4, 3], droplines: {vertical: 4, horizontal: 3}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [5, 1], droplines: {vertical: 5, horizontal: 1}, color: Blue, r: 3, strokeWidth: 0.5}

# ticks
      - Point: {coordinates: [6, 0], color: lightgrey, r: 0, droplines: {vertical: 6}}
      - Point: {coordinates: [7, 0], color: lightgrey, r: 0, droplines: {vertical: 7}}
      - Point: {coordinates: [8, 0], color: lightgrey, r: 0, droplines: {vertical: 8}}

# Alice surplus with no discrimination
      - Rectangle: {x1: 0, y1: params.P, x2: 1, y2: 9, fill: blue, show: params.P <= 8 && params.disc ==0}
      - Rectangle: {x1: 1, y1: params.P, x2: 2, y2: 7, fill: blue, show: params.P <= 6 && params.disc ==0}
      - Rectangle: {x1: 2, y1: params.P, x2: 3, y2: 5, fill: blue, show: params.P <= 4 && params.disc ==0}
      - Rectangle: {x1: 3, y1: params.P, x2: 4, y2: 3, fill: blue, show: params.P <= 2 && params.disc ==0}

# price line with no discrimination
      - Line:
          yIntercept: params.P
          color: Green
          strokeWidth: 1
          max: 7
          position: l
          label:
            text: P
            x: 7
          show: params.disc == 0

# marginal cost
      - Line:
          yIntercept: params.mc
          color: Red
          strokeWidth: 1
          position: l
          max: 7
          label:
            text: MC
            x: 7

# cost with no discr
      - Rectangle:
          x1: 0
          y1: 0
          x2: calcs.QA
          y2: params.mc
          fill: red
          show: params.disc == 0

# cost with discr
      - Rectangle: {x1: 0, y1: 0, x2: 1, y2: params.mc, fill: red, show: params.QD >= 1 && params.disc == 1}
      - Rectangle: {x1: 1, y1: 0, x2: 2, y2: params.mc, fill: red, show: params.QD >= 2 && params.disc == 1}
      - Rectangle: {x1: 2, y1: 0, x2: 3, y2: params.mc, fill: red, show: params.QD >= 4 && params.disc == 1}
      - Rectangle: {x1: 3, y1: 0, x2: 4, y2: params.mc, fill: red, show: params.QD >= 6 && params.disc == 1}



# profit with no discrimination
      - Rectangle: {x1: 0, y1: params.mc, x2: calcs.QA, y2: params.P, fill: green, show: params.disc ==0}

# profit with discr
      - Rectangle: {x1: 0, y1: params.mc, x2: 1, y2: 9, fill: green, show: params.QD >= 1 && params.disc == 1}
      - Rectangle: {x1: 1, y1: params.mc, x2: 2, y2: 7, fill: green, show: params.QD >= 2 && params.disc == 1}
      - Rectangle: {x1: 2, y1: params.mc, x2: 3, y2: 5, fill: green, show: params.QD >= 4 && params.disc == 1}
      - Rectangle: {x1: 3, y1: params.mc, x2: 4, y2: 3, fill: green, show: params.QD >= 6 && params.disc == 1}
































    middleGraph:
      xAxis:
        max: 9
        ticks: 0
        title: Bruno
      yAxis:
        max: 10.5
        ticks: 0


      objects:

      - Label:
              coordinates: [9, 0]
              text: "` \\\\text{    tickets} `"
      - Label:
              coordinates: [0, 10.5]
              text: "` \\\\text{euros per ticket}  `"


# Bruno demand
      - Point: {coordinates: [1, 6], droplines: {vertical: 1, horizontal: 6}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [2, 4], droplines: {vertical: 2, horizontal: 4}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [3, 2], droplines: {vertical: 3, horizontal: 2}, color: Blue, r: 3, strokeWidth: 0.5}

# ticks
      - Point: {coordinates: [4, 0], color: lightgrey, r: 0, droplines: {vertical: 4}}
      - Point: {coordinates: [5, 0], color: lightgrey, r: 0, droplines: {vertical: 5}}
      - Point: {coordinates: [6, 0], color: lightgrey, r: 0, droplines: {vertical: 6}}
      - Point: {coordinates: [7, 0], color: lightgrey, r: 0, droplines: {vertical: 7}}
      - Point: {coordinates: [8, 0], color: lightgrey, r: 0, droplines: {vertical: 8}}

# price line with no discrimination
      - Line:
          yIntercept: params.P
          color: Green
          strokeWidth: 1
          max: 7
          position: l
          label:
            text: P
            x: 7
          show: params.disc == 0

# Bruno surplus with no discrimination
      - Rectangle: {x1: 0, y1: params.P, x2: 1, y2: 6, fill: blue, show: params.P <= 5 && params.disc ==0}
      - Rectangle: {x1: 1, y1: params.P, x2: 2, y2: 4, fill: blue, show: params.P <= 3 && params.disc ==0}


# marginal cost
      - Line:
          yIntercept: params.mc
          color: Red
          strokeWidth: 1
          position: l
          max: 7
          label:
            text: MC
            x: 7

# cost with no discr
      - Rectangle:
          x1: 0
          y1: 0
          x2: calcs.QB
          y2: params.mc
          fill: red
          show: params.disc == 0


# cost with discr
      - Rectangle: {x1: 0, y1: 0, x2: 1, y2: params.mc, fill: red, show: params.QD >= 3 && params.disc == 1}
      - Rectangle: {x1: 1, y1: 0, x2: 2, y2: params.mc, fill: red, show: params.QD >= 5 && params.disc == 1}
      - Rectangle: {x1: 2, y1: 0, x2: 3, y2: params.mc, fill: red, show: params.QD >= 7 && params.disc == 1}



# profit with no discrimination
      - Rectangle: {x1: 0, y1: params.mc, x2: calcs.QB, y2: params.P, fill: green, show: params.disc ==0}

# profit with discr
      - Rectangle: {x1: 0, y1: params.mc, x2: 1, y2: 6, fill: green, show: params.QD >= 3 && params.disc == 1}
      - Rectangle: {x1: 1, y1: params.mc, x2: 2, y2: 4, fill: green, show: params.QD >= 5 && params.disc == 1}
      - Rectangle: {x1: 2, y1: params.mc, x2: 3, y2: 2, fill: green, show: params.QD >= 7 && params.disc == 1}




















    rightGraph:
      xAxis:
        max: 9
        ticks: 0
        title: Market
      yAxis:
        max: 10.5
        ticks: 0


      objects:

      - Label:
              coordinates: [9, 0]
              text: "` \\\\text{    tickets} `"
              position: l
      - Label:
              coordinates: [0, 10.5]
              text: "` \\\\text{euros per ticket}  `"

# market demand
      - Point: {coordinates: [1, 9], droplines: {vertical: 1, horizontal: 9}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [2, 7], droplines: {vertical: 2, horizontal: 7}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [3, 6], droplines: {vertical: 3, horizontal: 6}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [4, 5], droplines: {vertical: 4, horizontal: 5}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [5, 4], droplines: {vertical: 5, horizontal: 4}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [6, 3], droplines: {vertical: 6, horizontal: 3}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [7, 2], droplines: {vertical: 7, horizontal: 2}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [8, 1], droplines: {vertical: 8, horizontal: 1}, color: Blue, r: 3, strokeWidth: 0.5}


# consumer surplus with no discrimination
      - Rectangle: {x1: 0, y1: params.P, x2: 1, y2: 9, fill: blue, show: params.P <= 8 && params.disc ==0}
      - Rectangle: {x1: 1, y1: params.P, x2: 2, y2: 7, fill: blue, show: params.P <= 6 && params.disc ==0}
      - Rectangle: {x1: 2, y1: params.P, x2: 3, y2: 6, fill: blue, show: params.P <= 5 && params.disc ==0}
      - Rectangle: {x1: 3, y1: params.P, x2: 4, y2: 5, fill: blue, show: params.P <= 4 && params.disc ==0}
      - Rectangle: {x1: 4, y1: params.P, x2: 5, y2: 4, fill: blue, show: params.P <= 3 && params.disc ==0}
      - Rectangle: {x1: 5, y1: params.P, x2: 6, y2: 3, fill: blue, show: params.P <= 2 && params.disc ==0}


# ticks
      - Point: {coordinates: [4, 0], color: lightgrey, opacity: 2, r: 0, droplines: {vertical: 4}}
      - Point: {coordinates: [6, 0], color: lightgrey, r: 0, droplines: {vertical: 6}}
      - Point: {coordinates: [8, 0], color: lightgrey, r: 0, droplines: {vertical: 8}}

# price line with no discrimination
      - Line:
          yIntercept: params.P
          color: Green
          strokeWidth: 1
          max: 9
          position: l
          label:
            text: P
            x: 9
          show: params.disc == 0

# marginal cost
      - Line:
          yIntercept: params.mc
          color: Red
          strokeWidth: 1
          position: l
          max: 9
          label:
            text: MC
            x: 9

# cost
      - Rectangle:
          x1: 0
          y1: 0
          x2: calcs.Q
          y2: params.mc
          fill: red

# profit with no discrimination
      - Rectangle: {x1: 0, y1: params.mc, x2: calcs.Q, y2: params.P, fill: green, show: params.disc ==0}

# profit with discr
      - Rectangle: {x1: 0, y1: params.mc, x2: 1, y2: 9, fill: green, show: params.QD >= 1 && params.disc == 1}
      - Rectangle: {x1: 1, y1: params.mc, x2: 2, y2: 7, fill: green, show: params.QD >= 2 && params.disc == 1}
      - Rectangle: {x1: 2, y1: params.mc, x2: 3, y2: 6, fill: green, show: params.QD >= 3 && params.disc == 1}
      - Rectangle: {x1: 3, y1: params.mc, x2: 4, y2: 5, fill: green, show: params.QD >= 4 && params.disc == 1}
      - Rectangle: {x1: 4, y1: params.mc, x2: 5, y2: 4, fill: green, show: params.QD >= 5 && params.disc == 1}
      - Rectangle: {x1: 5, y1: params.mc, x2: 6, y2: 3, fill: green, show: params.QD >= 6 && params.disc == 1}
      - Rectangle: {x1: 6, y1: params.mc, x2: 7, y2: 2, fill: green, show: params.QD >= 7 && params.disc == 1}

# evaluation
      - Label:
          coordinates: [7,7]
          text: "` \\\\LARGE\\\\text{BINGO!} `" 
          position: c
          bgcolor: none
          color: green
          show: (params.disc == 0 && params.P == 5) || (params.disc == 1 && params.QD == 7 )






















    leftControls:
      title: " Type of discrimination: "
      divs:
      - html: "`  `"
      checkboxes:
      - param: disc
        label: "\\text{Perfectly discriminate}"


    middleControls:
      title: No discrimination
      description: Select a single linear price for everyone.
      divs:
      - html: "`  `"
      sliders:
      - param: P
        label: P
      show: params.disc == 0

    rightControls:
      title: Perfect discrimination
      description: Select how many units to sell.
      divs:
      - html: "`  `"
      sliders:
      - param: QD
        label: Q
      show: params.disc == 1











    explanation:
        divs:
          - html: "`
                  The monopolist's marginal cost is $1.50$ euros per ticket.
                  `"
          - html: "`
                  At a linear price of $P=${params.P}$ euros per ticket,
                  Alice buys $ ${calcs.QA}$ tickets, while
                  Bruno buys $ ${calcs.QB}$. The monopolist's profit
                  (green area in the right-hand graph, equal to the sum of the green areas in the
                  two graphs on the left and in the center) is therefore
                  $$
                  (${params.P}-1.50)\\\\times ${calcs.Q}
                  =
                  ${calcs.profit0}
                  \\\\quad \\\\text{euros}
                  $$
                  Alice's surplus (blue area in the left graph) is
                  $ ${calcs.CSA}$. 
                  Bruno's surplus (blue area in the center graph) is
                  $ ${calcs.CSB}$.
                  Consumer surplus (blue area in the right-hand graph, equal to the
                  sum of the blue areas in the
                  two graphs on the left and in the center) is ${calcs.CS}.
                  `"
            show: params.disc == 0

          - html: "`
                  The monopolist can sell the first ticket at 9 euros (to Alice). The corresponding
                  profit
                  (green area in the right-hand graph, equal to the sum of the green areas in the
                  two graphs on the left and in the center) is
                  $$
                  (9-1.50)
                  =
                  ${calcs.profit1}
                  \\\\quad \\\\text{euros}
                  $$
                  Consumer surplus is zero. 
                  `"
            show: params.disc == 1 && params.QD == 1

          - html: "`
                  The monopolist can sell the second ticket at 7 euros (to Alice)
                  <i><b> without having to lower the price of the first</b></i>. The corresponding
                  profit
                  (green area in the right-hand graph, equal to the sum of the green areas in the
                  two graphs on the left and in the center) is therefore
                  $$
                  (9-1.50)+(7-1.50)
                  =
                  ${calcs.profit1}
                  \\\\quad \\\\text{euros}
                  $$
                  Consumer surplus is zero. 
                  `"
            show: params.disc == 1 && params.QD == 2

          - html: "`
                  The monopolist can sell the third ticket at 6 euros (to Bruno)
                  <i><b> without having to lower the price of the previous ones</b></i>. The corresponding
                  profit
                  (green area in the right-hand graph, equal to the sum of the green areas in the
                  two graphs on the left and in the center) is therefore
                  $$
                  (9-1.50)+(7-1.50)+(6-1.50)
                  =
                  ${calcs.profit1}
                  \\\\quad \\\\text{euros}
                  $$
                  Consumer surplus is zero. 
                  `"
            show: params.disc == 1 && params.QD == 3

          - html: "`
                  The monopolist can sell the fourth ticket at 5 euros (to Alice)
                  <i><b> without having to lower the price of the previous ones</b></i>. The corresponding
                  profit
                  (green area in the right-hand graph, equal to the sum of the green areas in the
                  two graphs on the left and in the center) is therefore
                  $$
                  (9-1.50)+\\\\cdots+(5-1.50)
                  =
                  ${calcs.profit1}
                  \\\\quad \\\\text{euros}
                  $$
                  Consumer surplus is zero. 
                  `"
            show: params.disc == 1 && params.QD == 4

          - html: "`
                  The monopolist can sell the fifth ticket at 4 euros (to Bruno)
                  <i><b> without having to lower the price of the previous ones</b></i>. The corresponding
                  profit
                  (green area in the right-hand graph, equal to the sum of the green areas in the
                  two graphs on the left and in the center) is therefore
                  $$
                  (9-1.50)+\\\\cdots+(4-1.50)
                  =
                  ${calcs.profit1}
                  \\\\quad \\\\text{euros}
                  $$
                  Consumer surplus is zero. 
                  `"
            show: params.disc == 1 && params.QD == 5

          - html: "`
                  The monopolist can sell the sixth ticket at 3 euros (to Alice)
                  <i><b> without having to lower the price of the previous ones</b></i>. The corresponding
                  profit
                  (green area in the right-hand graph, equal to the sum of the green areas in the
                  two graphs on the left and in the center) is therefore
                  $$
                  (9-1.50)+\\\\cdots+(3-1.50)
                  =
                  ${calcs.profit1}
                  \\\\quad \\\\text{euros}
                  $$
                  Consumer surplus is zero. 
                  `"
            show: params.disc == 1 && params.QD == 6

          - html: "`
                  The monopolist can sell the seventh ticket at 2 euros (to Bruno)
                  <i><b> without having to lower the price of the previous ones</b></i>. The corresponding
                  profit
                  (green area in the right-hand graph, equal to the sum of the green areas in the
                  two graphs on the left and in the center) is therefore
                  $$
                  (9-1.50)+\\\\cdots+(2-1.50)
                  =
                  ${calcs.profit1}
                  \\\\quad \\\\text{euros}
                  $$
                  Consumer surplus is zero. 
                  `"
            show: params.disc == 1 && params.QD == 7

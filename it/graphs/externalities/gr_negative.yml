params:
- {name: SHOW, value: false}
- {name: EC, value: 0}

calcs:
  dummy: (0)

aspectRatio: 1

layout:
  TwoVerticalGraphsPlusSidebar:

    topGraph: 
      xAxis:
        max: 11
        ticks: 0
      yAxis:
        max: 25
        ticks: 0

      objects:

        - Label:
                coordinates: [11, 0]
                text: "` \\\\text{fardelli}  `"
                yPixelOffset: 8
        - Label:
                coordinates: [11, 0]
                text: "` \\\\text{(milioni)}  `"
                yPixelOffset: -8
        - Label:
                coordinates: [0, 25]
                text: "` \\\\text{euro} `"


# EC function (linear)
        - Line:
            point: [0,0]
            slope: (2)
            color: Violet
            strokeWidth: 1.5
            max: 10
            label:
              text: "` EC = 2Q `"
              x: 10
              position: l
            show: params.EC == 0

# EC function (quadratic)
        - Curve:
            fn: (x)^(2) / (4)
            color: Violet
            label:
              text: "` EC = Q^2 /4 `"
              x: 10
              position: l
            strokeWidth: 1.7
            show: params.EC == 1

# PC function (quadratic)
        - Curve:
            fn: (x)^(2) / (2)
            color: Red
            label:
              text: "` PC = Q^2 /2 `"
              x: 7
              position: l
            strokeWidth: 1.7

# SC function (EC linear)
        - Curve:
            fn: (x)^(2) / (2) + (2)*(x)
            color: Purple
            label:
              text: "` SC = PC + EC `"
              x: 5.2
              position: r
            strokeWidth: 1.7
            show: params.EC == 0

# SC function (EC quadratic)
        - Curve:
            fn: (x)^(2) / (2) + (x)^(2) / (4)
            color: Purple
            label:
              text: "` SC = PC + EC `"
              x: 5.7
              position: r
            strokeWidth: 1.7
            show: params.EC == 1






    bottomGraph: 
      xAxis:
        max: 11
        ticks: 0
      yAxis:
        max: 11
        ticks: 0

      objects:

        - Label:
                coordinates: [11, 0]
                text: "` \\\\text{fardelli}  `"
                yPixelOffset: 8
        - Label:
                coordinates: [11, 0]
                text: "` \\\\text{(milioni)}  `"
                yPixelOffset: -8
        - Label:
                coordinates: [0, 11]
                text: "` \\\\text{euro/fardello} `"

# demand function
        - Line:
            point: [0,10]
            slope: -(1)
            color: Blue
            strokeWidth: 1.5
            label:
              text: "` D = MPB = MSB `"
              x: 1
              position: bl

# MEC function (EC linear)
        - Line:
            yIntercept: 2
            color: Violet
            strokeWidth: 1.5
            label:
              text: "` MEC = 2 `"
              x: 10
              position: b
            show: params.EC == 0

# MEC function (EC quadratic)
        - Line:
            point: [0,0]
            slope: (0.5)
            color: Violet
            strokeWidth: 1.5
            label:
              text: "` MEC = Q/2 `"
              x: 9.5
              position: bl
            show: params.EC == 1

# MPC function
        - Line:
            point: [0,0]
            slope: (1)
            color: Red
            strokeWidth: 1.5
            max: 9
            label:
              text: "` MPC = Q  `"
              x: 9
              position: l

# MSC function (EC linear)
        - Line:
            point: [0,2]
            slope: (1)
            color: Purple
            strokeWidth: 1.5
            label:
              text: "` MSC = MPC + MEC  `"
              x: 8.5
              position: bl
            show: params.EC == 0

# MSC function (EC quadratic)
        - Line:
            point: [0,0]
            slope: (1.5)
            color: Purple
            strokeWidth: 1.5
            label:
              text: "` MSC = MPC + MEC  `"
              x: 7
              position: bl
            show: params.EC == 1

# points
        - Point:
            coordinates: [5, 5]
            droplines: {vertical: 5, horizontal: 5}
            color: Green
            r: 4
            strokeWidth: 0.5
        - Point:
            coordinates: [4, 6]
            droplines: {vertical: 4}
            color: Purple
            r: 0
            strokeWidth: 0.5

# surplus
        - Area:
            fn1: (10)-(x)
            fn2: (5)
            fill: blue
            opacity: 0.25
            min: 0
            max: 5
            show: params.SHOW == 0
        - Area:
            fn1: (5)
            fn2: (x)
            fill: Green
            opacity: 0.2
            min: 0
            max: 5
            show: params.SHOW == 0

# external cost (primo modo)
        - Area:
            fn: (2)
            fill: violet
            opacity: 0.25
            min: 0
            max: 5
            show: params.SHOW == 1 && params.EC == 0
        - Area:
            fn: (x)/(2)
            fill: violet
            opacity: 0.25
            min: 0
            max: 5
            show: params.SHOW == 1 && params.EC == 1

# external cost (secondo modo)
        - Area:
            fn1: (x)+(2)
            fn2: (x)
            fill: violet
            opacity: 0.25
            min: 0
            max: 5
            show: params.SHOW == 2 && params.EC == 0
        - Area:
            fn1: (1.5)*(x)
            fn2: (x)
            fill: violet
            opacity: 0.25
            min: 0
            max: 5
            show: params.SHOW == 2 && params.EC == 1

# deadweight loss
        - Area:
            fn1: (x)+(2)
            fn2: (10)-(x)
            fill: Gray
            opacity: 0.4
            min: 4
            max: 5
            show: params.SHOW == 3 && params.EC == 0
        - Area:
            fn1: (1.5)*(x)
            fn2: (10)-(x)
            fill: Gray
            opacity: 0.4
            min: 4
            max: 5
            show: params.SHOW == 3 && params.EC == 1





    sidebar:
      controls:
      - title: FIGURA 8.1
        description: "Selezionare una funzione di costo esterno:"
        radioGroup:
          param: EC
          options:
            - $EC = 2Q$
            - $EC = Q^2/4$
      - title: Esternalità negativa
        radioGroup:
          param: SHOW
          options:
            - Mostra surplus privato
            - Mostra costo esterno (primo modo)
            - Mostra costo esterno (secondo modo)
            - Mostra perdita secca
        divs:
        - html: <br>
        - html: "` La curva rossa nel grafico di sopra è il <i>costo privato</i>: quanto 
                  costa alle imprese nel loro complesso produrre ogni data quantità.
                  La curva rossa nel grafico di sotto è il <i>costo marginale privato</i>: quanto 
                  costa alle imprese nel loro complesso produrre un fardello in più. `"
        - html: <br>
        - html: "` La curva rosa nel grafico di sopra è il <i>costo esterno</i>: il danno ambientale
                  corrispondente a ogni data quantità. La curva rosa nel grafico di sotto è
                  il <i>costo marginale esterno</i>: il danno ambientale causato 
                  da un fardello in più. `"

    explanation:
      divs:
        - html: "` Nel mercato dell'acqua minerale in bottiglie di plastica, misurata in fardelli
                  (per esempio da $6\\\\times 1.5=9$ litri), la funzione
                  di domanda di mercato è $P=10-Q$, dove $P$ indica il prezzo a fardello
                  e $Q$ i milioni di fardelli consumati ogni giorno. La curva di offerta di mercato è $P=Q$ e
                  il costo esterno $EC=2Q$. In questo caso il costo marginale è 
                  costante, cioè ogni fardello in più inquina tanto quanto il precedente: $MEC=2$.
                  La quantità di equilibrio è $Q=5$, mentre la quantità socialmente
                  efficiente è $Q=4$. `"
          show: params.EC == 0
        - html: "` Nel mercato dell'acqua minerale in bottiglie di plastica, misurata in fardelli 
                  (per esempio da $6\\\\times 1.5=9$ litri), la funzione
                  di domanda di mercato è $P=10-Q$, dove $P$ indica il prezzo a fardello
                  e $Q$ i milioni di fardelli. La curva di offerta di mercato è $P=Q$ e
                  il costo esterno $EC=Q^2/4$. In questo caso il costo marginale è 
                  crescente, cioè ogni fardello in più inquina più del precedente: $MEC=Q/2$.
                  La quantità di equilibrio è $Q=5$, mentre la quantità socialmente
                  efficiente è $Q=4$. `"
          show: params.EC == 1















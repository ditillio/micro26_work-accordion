schema: EconSchema

params:

- {name: disc, value: 0}
- {name: mc, value: 1.5}
- {name: P, value: 3, min: 2, max: 9}
- {name: QD, value: 1, min: 1, max: 7}

- {name: PA, value: 5, min: 2, max: 9}
- {name: PB, value: 5, min: 2, max: 6}


calcs:

  PA: " (params.disc == 0) ? (params.P) : (params.PA) "
  PB: " (params.disc == 0) ? (params.P) : (params.PB) "

  QA: " (calcs.PA >= 8) ? (1) : ( (calcs.PA >= 6) ? (2) : ( (calcs.PA >= 4) ? (3) : ( 4 ) ) ) "
  QB: " (calcs.PB >= 7) ? (0) : ( (calcs.PB >= 5) ? (1) : ( (calcs.PB >= 3) ? (2) : ( 3 ) ) ) "
  Q: " (params.disc == 0) ? (calcs.QA)+(calcs.QB) : (params.QD) "

  CSA: " (params.P == 9) ? (0) : ( (params.P == 8) ? (1) : ( (params.P == 7) ? (2) : ( (params.P == 6) ? (4) : ( (params.P == 5) ? (6) : ( (params.P == 4) ? (9) : ( (params.P == 3) ? (12) : ( 16 ) ) ) ) ) ) ) "
  CSB: " (params.P == 9) ? (0) : ( (params.P == 8) ? (0) : ( (params.P == 7) ? (0) : ( (params.P == 6) ? (0) : ( (params.P == 5) ? (1) : ( (params.P == 4) ? (2) : ( (params.P == 3) ? (4) : ( 6 ) ) ) ) ) ) ) "

  CSAD: " (params.PA == 9) ? (0) : ( (params.PA == 8) ? (1) : ( (params.PA == 7) ? (2) : ( (params.PA == 6) ? (4) : ( (params.PA == 5) ? (6) : ( (params.PA == 4) ? (9) : ( (params.PA == 3) ? (12) : ( 16 ) ) ) ) ) ) ) "
  CSBD: " (params.PB == 9) ? (0) : ( (params.PB == 8) ? (0) : ( (params.PB == 7) ? (0) : ( (params.PB == 6) ? (0) : ( (params.PB == 5) ? (1) : ( (params.PB == 4) ? (2) : ( (params.PB == 3) ? (4) : ( 6 ) ) ) ) ) ) ) "

  profit0: (calcs.Q)*((params.P)-(params.mc)) # profit with no discrimination

  CS: (calcs.CSA)+(calcs.CSB)

  profit3: (calcs.QA)*((calcs.PA)-(params.mc))+(calcs.QB)*((calcs.PB)-(params.mc)) # profit with discrimination


aspectRatio: 2

layout:
  ThreeHorizontalGraphs:

    leftGraph:
      xAxis:
        max: 9
        ticks: 0
        title: Gruppo A
      yAxis:
        max: 10.5
        ticks: 0


      objects:

      - Label:
              coordinates: [7, 0]
              text: "` \\\\text{    licenses} `"
              yPixelOffset: 9
              position: l
      - Label:
              coordinates: [7, 0]
              text: "` \\\\text{(thousands)} `"
              yPixelOffset: -9
              position: l
      - Label:
              coordinates: [0, 10.5]
              text: "` \\\\text{euro/license}  `"

# Alice demand
      - Point: {coordinates: [1, 9], droplines: {vertical: 1, horizontal: 9}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [2, 7], droplines: {vertical: 2, horizontal: 7}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [3, 5], droplines: {vertical: 3, horizontal: 5}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [4, 3], droplines: {vertical: 4, horizontal: 3}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [5, 1], droplines: {vertical: 5, horizontal: 1}, color: Blue, r: 3, strokeWidth: 0.5}

# ticks
      - Point: {coordinates: [6, 0], color: lightgrey, r: 0, droplines: {vertical: 6}}
      - Point: {coordinates: [7, 0], color: lightgrey, r: 0, droplines: {vertical: 7}}

# Alice surplus with or without discrimination
      - Rectangle: {x1: 0, y1: calcs.PA, x2: 1, y2: 9, fill: blue, show: calcs.PA <= 8}
      - Rectangle: {x1: 1, y1: calcs.PA, x2: 2, y2: 7, fill: blue, show: calcs.PA <= 6}
      - Rectangle: {x1: 2, y1: calcs.PA, x2: 3, y2: 5, fill: blue, show: calcs.PA <= 4}
      - Rectangle: {x1: 3, y1: calcs.PA, x2: 4, y2: 3, fill: blue, show: calcs.PA <= 2}

# price line with no discrimination
      - Line:
          yIntercept: params.P
          color: Green
          strokeWidth: 1
          max: 7
          position: l
          label:
            text: P
            x: 7
          show: params.disc == 0

# price line with discrimination
      - Line:
          yIntercept: calcs.PA
          color: Green
          strokeWidth: 1
          max: 7
          position: l
          label:
            text: P_A
            x: 7
          show: params.disc == 1

# marginal cost
      - Line:
          yIntercept: params.mc
          color: Red
          strokeWidth: 1
          position: l
          max: 7
          label:
            text: MC
            x: 7

# cost with or without discr
      - Rectangle:
          x1: 0
          y1: 0
          x2: calcs.QA
          y2: params.mc
          fill: red



# profit with or without discrimination
      - Rectangle: {x1: 0, y1: params.mc, x2: calcs.QA, y2: calcs.PA, fill: green}

# evaluation
      - Label:
          coordinates: [5,9]
          text: "` \\\\LARGE\\\\text{BINGO!} `" 
          position: c
          bgcolor: none
          color: green
          show: (params.disc == 1 && calcs.PA == 7)
































    middleGraph:
      xAxis:
        max: 9
        ticks: 0
        title: Gruppo B
      yAxis:
        max: 10.5
        ticks: 0


      objects:

      - Label:
              coordinates: [7, 0]
              text: "` \\\\text{    licenses} `"
              yPixelOffset: 9
              position: l
      - Label:
              coordinates: [7, 0]
              text: "` \\\\text{(thousands)} `"
              yPixelOffset: -9
              position: l
      - Label:
              coordinates: [0, 10.5]
              text: "` \\\\text{euro/license}  `"


# Bruno demand
      - Point: {coordinates: [1, 6], droplines: {vertical: 1, horizontal: 6}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [2, 4], droplines: {vertical: 2, horizontal: 4}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [3, 2], droplines: {vertical: 3, horizontal: 2}, color: Blue, r: 3, strokeWidth: 0.5}

# ticks
      - Point: {coordinates: [4, 0], color: lightgrey, r: 0, droplines: {vertical: 4}}
      - Point: {coordinates: [5, 0], color: lightgrey, r: 0, droplines: {vertical: 5}}
      - Point: {coordinates: [6, 0], color: lightgrey, r: 0, droplines: {vertical: 6}}
      - Point: {coordinates: [7, 0], color: lightgrey, r: 0, droplines: {vertical: 7}}

# price line with no discrimination
      - Line:
          yIntercept: params.P
          color: Green
          strokeWidth: 1
          max: 7
          position: l
          label:
            text: P
            x: 7
          show: params.disc == 0

# price line with discrimination
      - Line:
          yIntercept: calcs.PB
          color: Green
          strokeWidth: 1
          max: 7
          position: l
          label:
            text: P_B
            x: 7
          show: params.disc == 1

# Bruno surplus with or without discrimination
      - Rectangle: {x1: 0, y1: calcs.PB, x2: 1, y2: 6, fill: blue, show: calcs.PB <= 5}
      - Rectangle: {x1: 1, y1: calcs.PB, x2: 2, y2: 4, fill: blue, show: calcs.PB <= 3}


# marginal cost
      - Line:
          yIntercept: params.mc
          color: Red
          strokeWidth: 1
          position: l
          max: 7
          label:
            text: MC
            x: 7

# cost with or without discr
      - Rectangle:
          x1: 0
          y1: 0
          x2: calcs.QB
          y2: params.mc
          fill: red





# profit with or without discrimination
      - Rectangle: {x1: 0, y1: params.mc, x2: calcs.QB, y2: calcs.PB, fill: green}

# evaluation
      - Label:
          coordinates: [5,9]
          text: "` \\\\LARGE\\\\text{BINGO!} `" 
          position: c
          bgcolor: none
          color: green
          show: (params.disc == 1 && calcs.PB == 4)



















    rightGraph:
      xAxis:
        max: 9
        ticks: 0
        title: Mercato
      yAxis:
        max: 10.5
        ticks: 0


      objects:

      - Label:
              coordinates: [8, 0]
              text: "` \\\\text{     licenses} `"
              yPixelOffset: 9
              position: l
      - Label:
              coordinates: [8, 0]
              text: "` \\\\text{  (thousands)} `"
              yPixelOffset: -9
              position: l
      - Label:
              coordinates: [0, 10.5]
              text: "` \\\\text{euro/license}  `"

# market demand
      - Point: {coordinates: [1, 9], droplines: {vertical: 1, horizontal: 9}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [2, 7], droplines: {vertical: 2, horizontal: 7}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [3, 6], droplines: {vertical: 3, horizontal: 6}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [4, 5], droplines: {vertical: 4, horizontal: 5}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [5, 4], droplines: {vertical: 5, horizontal: 4}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [6, 3], droplines: {vertical: 6, horizontal: 3}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [7, 2], droplines: {vertical: 7, horizontal: 2}, color: Blue, r: 3, strokeWidth: 0.5}
      - Point: {coordinates: [8, 1], droplines: {vertical: 8, horizontal: 1}, color: Blue, r: 3, strokeWidth: 0.5}


# consumer surplus with no discrimination
      - Rectangle: {x1: 0, y1: params.P, x2: 1, y2: 9, fill: blue, show: params.P <= 8 && params.disc ==0}
      - Rectangle: {x1: 1, y1: params.P, x2: 2, y2: 7, fill: blue, show: params.P <= 6 && params.disc ==0}
      - Rectangle: {x1: 2, y1: params.P, x2: 3, y2: 6, fill: blue, show: params.P <= 5 && params.disc ==0}
      - Rectangle: {x1: 3, y1: params.P, x2: 4, y2: 5, fill: blue, show: params.P <= 4 && params.disc ==0}
      - Rectangle: {x1: 4, y1: params.P, x2: 5, y2: 4, fill: blue, show: params.P <= 3 && params.disc ==0}
      - Rectangle: {x1: 5, y1: params.P, x2: 6, y2: 3, fill: blue, show: params.P <= 2 && params.disc ==0}


# ticks
      - Point: {coordinates: [4, 0], color: lightgrey, opacity: 2, r: 0, droplines: {vertical: 4}}
      - Point: {coordinates: [6, 0], color: lightgrey, r: 0, droplines: {vertical: 6}}
      - Point: {coordinates: [8, 0], color: lightgrey, r: 0, droplines: {vertical: 8}}

# price line with no discrimination
      - Line:
          yIntercept: params.P
          color: Green
          strokeWidth: 1
          max: 9
          position: l
          label:
            text: P
            x: 9
          show: params.disc == 0

# reminder optimal price line with no discrimination
      - Line:
          yIntercept: 5
          color: Green
          strokeWidth: 1
          max: 9
          position: l
          label:
            text: P
            x: 9
          show: params.disc == 1

# marginal cost
      - Line:
          yIntercept: params.mc
          color: Red
          strokeWidth: 1
          position: l
          max: 9
          label:
            text: MC
            x: 9

# cost without discr
      - Rectangle:
          x1: 0
          y1: 0
          x2: calcs.Q
          y2: params.mc
          fill: red
          show: params.disc == 0

# reminder cost without discr
      - Rectangle:
          x1: 0
          y1: 0
          x2: 4
          y2: params.mc
          fill: red
          show: params.disc == 1

# profit with no discrimination
      - Rectangle: {x1: 0, y1: params.mc, x2: calcs.Q, y2: params.P, fill: green, show: params.disc ==0}

# reminder max profit with no discrimination
      - Rectangle: {x1: 0, y1: params.mc, x2: 4, y2: 5, fill: green, show: params.disc == 1}



# evaluation
      - Label:
          coordinates: [7,7]
          text: "` \\\\LARGE\\\\text{BINGO!} `" 
          position: c
          bgcolor: none
          color: green
          show: (params.disc == 0 && params.P == 5) || (params.disc == 1 && params.QD == 7 )


      - Arrow:
          begin: [6,8]
          end: [2,3]
          color: Darkgreen
          strokeWidth: 1
          bgcolor: none
          show: params.disc == 1
      - Label:
          text: " \\text{maximum profit without} "
          coordinates: [6,8]
          yPixelOffset: 9
          show: params.disc == 1
      - Label:
          text: " \\text{discrimination} = 14 "
          coordinates: [6,8]
          yPixelOffset: -9
          show: params.disc == 1









    leftControls:
      title: " Type of discrinination: "
      divs:
      - html: "`  `"
      checkboxes:
      - param: disc
        label: "\\text{Discriminate groups}"


    middleControls:
      title: No discrimination
      description: Select a single linear price for everyone.
      divs:
      - html: "`  `"
      sliders:
      - param: P
        label: P
      show: params.disc == 0

    rightControls:
      title: Discriminate professionals / students
      description: Select a linear price for professionals and  one for students.
      divs:
      - html: "`  `"
      sliders:
      - param: PA
        label: P_A
      - param: PB
        label: P_B
      show: params.disc == 1









    explanation:
        divs:
          - html: "`
                  The monopolist’s marginal cost is $1.50$ euros per license.
                  `"
          - html: "`
                  At a linear price of $P=${params.P}$ euros per license,
                  group A buys $ ${calcs.QA}$ thousand licenses, while
                  group B buys $ ${calcs.QB}$ thousand. The monopolist’s profit
                  (green area in the right graph, equal to the sum of the green areas in
                  the left and middle graphs) is therefore
                  $$
                  (${params.P}-1.50)\\\\times ${calcs.Q}
                  =
                  ${calcs.profit0}
                  \\\\quad \\\\text{thousand euros}
                  $$
                  Group A’s surplus (blue area in the left graph) is
                  $ ${calcs.CSA}$ thousand euros. 
                  Group B’s surplus (blue area in the middle graph) is
                  $ ${calcs.CSB}$ thousand euros. 
                  Consumer surplus (blue area in the right graph, equal to the
                  sum of the blue areas in the
                  left and middle graphs) is ${calcs.CS} thousand euros.
                  `"
            show: params.disc == 0

          - html: "`
                  At linear prices $P_A=${calcs.PA}$ and $P_B=${calcs.PB}$ 
                  groups A and B  buy $ ${calcs.QA}$
                  and $ ${calcs.QB}$ thousand licenses, respectively. The monopolist’s profit
                  (sum of the green areas in
                  the left and middle graphs) is therefore
                  $$
                  (${calcs.PA}-1.50)\\\\times ${calcs.QA}
                  +(${calcs.PB}-1.50)\\\\times ${calcs.QB}
                  =
                  ${calcs.profit3}
                  \\\\quad \\\\text{thousand euros}
                  $$
                  Group A’s surplus (blue area in the left graph) is
                  $ ${calcs.CSAD}$ thousand euros. 
                  Group B’s surplus (blue area in the middle graph) is
                  $ ${calcs.CSBD}$ thousand euros. 
                  `"
            show: params.disc == 1

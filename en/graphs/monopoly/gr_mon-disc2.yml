
schema: EconSchema

params:

- {name: Q, value: 100, min: 0, max: 400, round: 10}
- {name: disc, value: 0}
- {name: mc, value: 2}


calcs:
  P: (10)-(params.Q)/(50) # price with no discrimination
  profit: (params.Q)*((calcs.P)-(params.mc)) # profit with no discrimination
  profitdisc: ((8)+((calcs.P)-(2)))*(params.Q)/(2) # profit with discrimination


aspectRatio: 1.3

layout:
  OneGraphPlusSidebar:

    graph:
      xAxis:
        orient: bottom
        min: 0
        max: 600
        ticks: 0
      yAxis:
        orient: left
        min: -(3)
        max: 12
        ticks: 0
      objects:
      - Label:
              coordinates: [600, 0]
              text: "` \\\\; \\\\text{GB} `"
              yPixelOffset: 9
              position: l
      - Label:
              coordinates: [600, 0]
              text: "` \\\\text{(millions)} `"
              yPixelOffset: -9
              position: l
      - Label:
            coordinates: [0, 12]
            text: "` \\\\text{euro/GB}  `"
      - Point:
          coordinates: [0, 0]
          droplines:
            horizontal: 0
          color: black
          r: 0


# market demand function
      - Line:
          yIntercept: (10)
          slope: -(1)/(50)
          color: Blue
          max: (500)
          strokeWidth: 1.5
          position: b
          label:
            text: "` D `"
            x: 480
            bgcolor: none
      - Point:
          coordinates: [0, 10]
          droplines:
            horizontal: 10
          color: Blue
          r: 0
      - Point:
          coordinates: [500, 0]
          color: Blue
          droplines:
            vertical: 500
          r: 0

# marginal revenue
      - Line:
          yIntercept: (10)
          slope: -(1)/(25)
          color: Green
          strokeWidth: 1.5
          position: l
          label:
            text: "` MR = 10 - Q/25 `"
            y: -(2)


# marginal cost
      - Line:
          yIntercept: (2)
          color: Red
          strokeWidth: 1.5
          position: b
          label:
            text: "` MC  `"
            x: (580)
      - Point:
          coordinates: [0, 2]
          droplines:
            horizontal: 2
          color: Red
          r: 0



# chosen point
      - Point:
          coordinates: [params.Q, calcs.P]
          color: Blue
          r: 3
          droplines:
            vertical: params.Q.toFixed(1)
            horizontal: calcs.P.toFixed(2)
          strokeWidth: 0.5


# monopolist profit/loss
      - Rectangle:
          x1: 0
          y1: 2
          x2: params.Q
          y2: (10)-(params.Q)/(50)
          fill: green
          show: params.Q < 400
      - Area:
          fn1: min((200),(10)-(x)/(50))
          fn2: calcs.P
          fill: purple
          opacity: 0.3
          min: 0
          max: params.Q
          show: params.Q > 400

# consumer surplus / additional prod surplus with discrimination
      - Area:
          fn1: (10)-(x)/(50)
          fn2: max(2,calcs.P)
          fill: blue
          opacity: 0.2
          min: 0
          max: min(400,params.Q)
          show: params.disc == 0
      - Area:
          fn1: (10)-(x)/(50)
          fn2: max(2,calcs.P)
          fill: green
          min: 0
          max: min(400,params.Q)
          show: params.disc == 1

# deadweight loss
      - Area:
          fn1: (2)
          fn2: (10)-(x)/(50)
          fill: gray
          opacity: 0.4
          min: 2
          max: params.Q
          show: params.Q > 400


# evaluation
      - Label:
          coordinates: [450,7]
          text: "` \\\\LARGE\\\\text{BINGO!} `" 
          position: c
          bgcolor: none
          color: green
          show: ( params.Q == 200 && params.disc == 0 ) || ( params.Q == 400 && params.disc == 1 )







    sidebar:
      controls:

      - title: FIGURE 5.7
        # description: Scegliere il tipo di compensazione per visualizzare 
        #               vincolo di bilancio e scelta ottima corrispondenti ai nuovi prezzi e al 
        #               reddito compensato.
        radioGroup:
          param: disc
          options:
            - Linear prices
            - Perfect discrimination


      - title: Linear prices
        description: Find the profit-maximizing quantity. 
        sliders:
        - param: Q
          label: "` Q `"
        divs:
          - html: "` Producing $Q=0$ gives zero profits. `"
            show: params.Q == 0
          - html: "` To sell $ ${params.Q}$ million gigabytes, the price must be 
                      equal to $ ${calcs.P.toFixed(2)}$ euro per gigabyte. The corresponding profit
                      (green area) is equal to
                    $$
                    (${calcs.P.toFixed(2)}-${params.mc})\\\\times ${params.Q.toFixed(1)} = ${calcs.profit.toFixed(2)}
                    $$
                    `"
            show: params.Q > 0
          - html: "` This is the maximum profit achievable with linear prices.
                      Without discriminating, the monopolist cannot do better.
                     `"
            show: params.Q == 200
        show: params.disc == 0


      - title: Perfect discrimination
        description: Find the profit-maximizing quantity. 
        sliders:
        - param: Q
          label: "` Q `"
        divs:
          - html: "` Producing $Q=0$ gives zero profits. `"
            show: params.Q == 0
          - html: "` By selling $ ${params.Q} $ million gigabytes, and discriminating perfectly,
                  the monopolist manages to capture the entire surplus. Profit  (green area) is
                      equal to $ ${calcs.profitdisc.toFixed(2)} $. Consumer surplus is zero.
                    `"
            show: params.Q > 0
        show: params.disc == 1






    # explanation:
    #   divs:
    #     - html: <br><br>
    #       show: params.Q == 0
    #     - html: "` Il costo marginale del monopolista è $MC=2$. `"
    #     - html: "` La curva di domanda di ciascun consumatore è rappresentata dalla curva $D^i$. `"
    #     - html: "` Ad un prezzo lineare di $ ${calcs.P.toFixed(2)} $ euro / 100GB, ciascun consumatore
    #               acquista $ ${calcs.GB.toFixed(0)}$ gigabytes.   `"
    #       show: params.disc == 0
    #     - html: "` Ciascun consumatore ottiene un surplus pari all'area azzurra, e da ciascun consumatore
    #               il monopolista ottiene un profitto pari all'area verde. `"
    #       show: params.disc == 0 && params.Q <= 2
    #     - html: "` Ciascun consumatore ottiene un surplus pari alla somma delle aree azzurra e viola,
    #               e da ciascun consumatore il monopolista realizza una perdita pari alla somma delle
    #               aree viola e grigia. `"
    #       show: params.disc == 0 && params.Q > 2



